<!DOCTYPE html>
<html>

<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>Server is loading</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
</head>

<body>
    <h1>Server is loading ...</h1>
    <p id="text"></p>
    <progress id="progress" value="0" max="100"></progress>

    <script>
        const progress = document.getElementById('progress')
        const text = document.getElementById('text')
        setInterval(async () => {

            const data = await (await fetch('/api/load')).json()
            const ratio = data.loaded / data.count
            const percentage = ratio * 100
            progress.value = percentage

            text.innerHTML = data.loaded + '/' + data.count + ' - ( ' + (parseInt(percentage * 100) / 100) + '% )'

            if (ratio == 1) location.reload()
        }, 100)
    </script>
</body>

</html>